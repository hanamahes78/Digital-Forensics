# Network Analysis of Malware Activity in Active Directory

## Introduction
The PCAP file analyzed in this case originates from an Active Directory (AD) environment and contains network traffic simulating a corporate network compromised by malware. The captured data provides insights into malicious communication patterns within the organization’s internal network during the infection event.

The LAN configuration details are as follows:
- LAN segment range: 10.0.0[.]0/24 (10.0.0[.]0 through 10.0.0[.]255)
- Domain: work4us[.]org
- Domain Controller IP address: 10.0.0[.]6
- Domain Controller host name: WORK4US-DC
- LAN segment gateway: 10.0.0[.]1
- LAN segment broadcast address: 10.0.0[.]255

Within this AD environment, all Windows user accounts follow the firstname.lastname naming format.

## Tools Used
In this case study, `Wireshark` was used to analyze the network traffic generated by the malware. Wireshark enables real-time packet capture and in-depth inspection of network data, offering detailed insights into communication patterns. The tool provides protocol-level analysis, including SMTP traffic, which facilitates the identification of stolen information such as transmitted login credentials.
Wireshark proves to be an essential tool for detecting and analyzing suspicious activity within network communications.

## Digital Evidence Description
The digital evidence analyzed in this case consisted of a PCAP file containing captured network communications generated during the simulated malware infection. The traffic includes HTTP sessions related to malware download and possible command-and-control (C2) communication. Certain packets within the capture revealed connections to external hosts and the transfer of potentially malicious data.

## Forensic Process
1. **Opening the PCAP File in Wireshark**<br>
The provided PCAP file was opened in Wireshark for detailed packet-level inspection and filtering.

2. **Applying Protocol Filters**<br>
Protocol filters were applied to identify suspicious traffic, focusing on HTTP and potential malware download activity.

3. **Following Suspicious Streams**<br>
`Follow TCP Stream` was used to reconstruct communication sessions and examine transferred content.

4. **Exporting the Malicious File**<br>
Using Wireshark’s Export Objects and HTTP option, a suspicious binary file named 86607.dat was extracted for further analysis.

5. **Analyzing the Extracted File**<br>
The extracted files will go through static and behavioral analysis to determine their properties.

## Findings
1. **Victim’s IP Address**<br>
<img width="600" alt="Findings-1" src=""><br>
The infected host was identified with the IP address `10.0.0.149`.

2. **Victim’s Port Number**<br>
<img width="600" alt="Findings-2a" src=""><br>
<img width="600" alt="Findings-2b" src=""><br>
The local port associated with the suspicious communication was `49668`.

3. **Domain Name**<br>
<img width="600" alt="Findings-3a" src=""><br>
<img width="600" alt="Findings-3b" src=""><br>
By following the TCP stream of suspicious packets, the external domain or host involved in communication was identified as `128.254.207.55`.

4. **URL Associated with the Infection**<br>
<img width="600" alt="Findings-4" src=""><br>
The infection activity involved an HTTP request to the following URL `http[:]//128.254.207.55/86607[.]dat`.

5. **Information on the Extracted Malicious File**<br>
<img width="600" alt="Findings-5a" src=""><br>
<img width="600" alt="Findings-5b" src=""><br>
The suspicious file was identified by following the HTTP stream corresponding to the infection-related traffic.
Using Wireshark’s `Export Objects → HTTP`, the file named `86607.dat` was extracted for further examination.<br>
   <img width="600" alt="Findings-5c" src=""><br>
   <img width="600" alt="Findings-5d" src=""><br>
   Analysis conducted via VirusTotal determined that 86607.dat was classified as a `Trojan and spyware threat`.<br>
   <img width="600" alt="Findings-5e" src=""><br>
   Additional technical details about the file are as follows:
   - File size: 1,768,280 bytes
   - SHA-256 hash:
     713207d9d9875ec88d2f3a53377bf8c2d620147a4199eb183c13a7e957056432
   - File type and header: Identified as a Windows binary executable associated with data exfiltration behavior

## Conclusion
The forensic analysis of the PCAP file successfully identified malicious network activity within a simulated Active Directory environment. Through Wireshark, suspicious HTTP traffic was isolated, and a malicious binary file (86607.dat) was recovered. Subsequent verification using VirusTotal confirmed that the file was a Trojan/Spyware sample associated with malware infection behavior.

This investigation highlights the critical role of network forensic techniques in identifying indicators of compromise (IOCs), reconstructing malware communication patterns, and validating threats using external intelligence platforms such as VirusTotal. The integration of network analysis and threat intelligence significantly enhances the accuracy and reliability of digital forensic investigations in malware-related incidents.